---
layout: post
title: "C/C++对文本文件和二进制文件的问题" 
comments: true
share: true
tags: C/C++
---


## 基本知识： ##

从文件编码的方式来看，文件可分为ASCII码文件和二进制码文件两种。ASCII文件也称为文本文件，这种文件在磁盘中存放时每个字符对应一个字节，用于存放对应的ASCII码。源程序文件就是ASCII文件。


在C中，指定模式里带了'b'就说明是二进制读写。

二进制文件是按二进制的编码方式来存放文件的。例如，数5678的存储形式为：00010110   00101110只占二个字节。C系统在处理这些文件时，并不区分类型，都看成是字符流，按字节进行处理。

那些没有规定格式的，由可理解的的ASCII以及其他编码文字组成的文件都是文本文件，如C源程序文件，HTML超文本，XML。除此之外的其他文件都是二进制文件，如Word文件DOC，图象格式文件JPG。

二进制方式很简单，读文件时，会原封不动的读出文件的全部內容，写的時候，也是把內存缓冲区的內容原封不动的写到文件中。

而文本方式就不一样了，在写文件时，会将换行符号CRLF(0x0D 0x0A)全部转换成单个的0x0A，并且当遇到结束符CTRLZ(0x1A)时，就认为文件已经结束。相应的，写文件时，会将所有的0x0A换成0x0D 0x0A。（**正是这个原因，在我之前用C复制文件的时候发现用文本方式仍旧可以原样复制，但是若要对文件进行加密的时候，会发现文件大小变化了！！！！**）

C语言存取文件文本模式和二进制模式对fputc fwrite函数写到文件的内容没有其他影响，仍然都是内容中的二进制数据按字节写出到文件中。而 fprintf则将二进制转换成ASCII输出到文件中，fscanf将读取的ascii码转换成二进制放到内存中，效率略低。

fgetc fputc 都是按照字节存取，无论文本模式还是二进制模式打开，都按照一个一个字节读取。


